nav(class='navbar navbar-inverse navbar-fixed-bottom' id='bottom-nav')
  form(class='navbar-form form-inline navbar-right', id='chat', action='')
    button(class='btn btn-default jub-nav-item', type='button', id='join-dj',
           data-toggle='tooltip', data-placement='top',
           title='Click to DJ')
      span(id='join-dj-icon', class='glyphicon glyphicon-user')
    input(class='form-control jub-nav-input jub-nav-item', id='chat-input', autocomplete='off',
          placeholder='Chat')

script.

  // DJ button
  $('#join-dj').on('click', function() {
    if (!djing) {
      socket.emit('add dj', getUsername());
      console.log("add dj");
      djing = true;
    } else {
      socket.emit('remove dj', getUsername());
      console.log("remove dj");
      djing = false;
    }
    drawDjState();
  });

  // Some other part of the page wants to set the DJ state
  $('#join-dj').on('set-dj-state', function(e, newState) {
    console.log('dj-state', newState);
    djing = newState;
    drawDjState();
  });

  // Server assigns 'djing' state
  socket.on('user djing', function(state) {
    $('#join-dj').trigger('set-dj-state', state);
  });


  function drawDjState() {
    var elem = $('#join-dj');
    if (djing) {
      elem.css('background', '#2DB85A');
      elem.css('color', '#000');
      $('#join-dj-icon').attr('class', 'glyphicon glyphicon-headphones');
      $('#join-dj').attr('title', 'Stop DJing');
    } else {
      elem.css('background', '#3F2C52');
      elem.css('color', '#FFFFFF');
      $('#join-dj-icon').attr('class', 'glyphicon glyphicon-user');
      $('#join-dj').attr('title', 'Click to DJ');
    }
  }

  // Client chat message submission
  $('#chat').submit(function() {
    var msg = $('#chat-input').val();
    var username = getCookie('username');
    if (username == '') {
      alert('You must be logged in to chat.')
    } else {
      socket.emit('chat message', {
        user: username,
        text: msg,
      });
    }
    $('#chat-input').val('');
    return false;
  });



